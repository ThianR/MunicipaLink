/* ============================================
   MUNICIPALINK - STYLESHEET
   ============================================
   
   TABLA DE CONTENIDOS:
   
   1. Variables y Configuración .............. línea 15
   2. Reset y Base ........................... línea 58
   3. Layout Principal
      3.1 Screen Management .................. línea 73
      3.2 Login Screen ....................... línea 86
      3.3 App Header ......................... línea 172
      3.4 Sidebar ............................ línea 432
      3.5 Content Areas ...................... línea 705
   4. Componentes UI
      4.1 Botones ............................ línea 461
      4.2 Formularios ........................ línea 452
      4.3 Toasts ............................. línea 563
      4.4 Modales ............................ línea 623
      4.5 Tabs ............................... línea 746
      4.6 Cards .............................. línea 835
      4.7 Badges ............................. línea 859
   5. Vistas Específicas
      5.1 Reportes ........................... línea 727
      5.2 Detalle de Reporte ................. línea 1043
      5.3 Perfil de Usuario .................. línea 1315
      5.4 Comentarios ........................ línea 1609
   6. Gamificación ........................... línea 1450
   7. Responsive Design ...................... línea 1681
   8. Utilidades y Helpers ................... línea 2315
   9. Debug Tools ............................ línea 2413
   
   ============================================ */

:root {
    /* Colors */
    --primary: #10b981;
    --primary-dark: #059669;
    --primary-light: #d1fae5;

    /* Backgrounds */
    --bg-light: #f3f4f6;
    --card-bg: #ffffff;
    --log-bg: #1f2937;

    /* Text Colors */
    --text-main: #111827;
    --text-muted: #6b7280;
    --log-text: #f3f4f6;

    /* Spacing */
    --spacing-xs: 0.25rem;
    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 1.5rem;
    --spacing-xl: 2rem;

    /* Typography */
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;
    --font-size-2xl: 1.5rem;

    /* Border Radius */
    --radius-sm: 8px;
    --radius: 12px;
    --radius-lg: 16px;
    --radius-xl: 20px;
    --radius-full: 9999px;

    /* Shadows */
    --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Outfit', sans-serif;
    background-color: var(--bg-light);
    color: var(--text-main);
    overflow: hidden;
    height: 100dvh;
    /* Dynamic viewport height */
}

/* Screen Management */
.screen {
    display: none;
    height: 100dvh;
    width: 100vw;
    overflow: hidden;
}

.screen.active {
    display: flex;
    flex-direction: column;
}

/* Login Screen */
#screen-login {
    justify-content: center;
    align-items: center;
    background: linear-gradient(135deg, #10b981 0%, #064e3b 100%);
}

.login-card {
    background: white;
    padding: 3rem;
    border-radius: 24px;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    text-align: center;
    width: 90%;
    max-width: 400px;
}

.login-card h1 {
    font-size: 2rem;
    font-weight: 800;
    margin-bottom: 0.5rem;
    color: var(--primary-dark);
}

.login-card p {
    color: var(--text-muted);
    margin-bottom: 2rem;
}

.btn-login-google {
    width: 100%;
    padding: 1rem;
    background: white;
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s;
}

.btn-login-google:hover {
    background: #f9fafb;
}

.btn-guest {
    color: var(--primary);
    background: none;
    border: none;
    font-weight: 600;
    cursor: pointer;
    text-decoration: underline;
    font-family: inherit;
}

.auth-form {
    margin-top: 1rem;
    text-align: left;
}

.divider {
    display: flex;
    align-items: center;
    text-align: center;
    margin: 1.5rem 0;
    color: var(--text-muted);
}

.divider::before,
.divider::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid #e5e7eb;
}

.divider:not(:empty)::before {
    margin-right: .5em;
}

.divider:not(:empty)::after {
    margin-left: .5em;
}

/* App Screen Layout */
.main-header {
    height: 60px;
    /* Reduced from 70px */
    background: white;
    padding: 0 1.5rem;
    /* Reduced padding */
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 100;
    flex-shrink: 0;
    border-bottom: 1px solid #f3f4f6;
    /* Subtle border */
}

.logo {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary);
}

.logo h1 {
    font-size: 1.25rem;
    font-weight: 700;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.user-info span {
    font-weight: 600;
    font-size: 0.875rem;
}

/* Reports Header Layout Optimized */
.reports-header-layout {
    display: flex;
    justify-content: space-between;
    align-items: center;
    /* Align Center for single row feel */
    flex-wrap: wrap;
    gap: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #eee;
    margin-bottom: 1rem;
}

.header-title h2 {
    font-size: 1.25rem;
    /* Slightly smaller for compactness */
    font-weight: 700;
    margin: 0;
    color: var(--text-main);
}

.reports-controls-container {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}

/* Unified Filters Toolbar */
.reports-toolbar {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    flex-wrap: wrap;
}

.search-group {
    position: relative;
    min-width: 220px;
}

.search-input {
    width: 100%;
    padding: 0.75rem 0.75rem 0.75rem 2.5rem;
    /* Matches muni-selector padding */
    border: 2px solid #e5e7eb;
    /* Matches muni-selector border */
    border-radius: 8px;
    font-size: 0.875rem;
    height: auto;
    /* Let padding define height like muni-selector */
    background: #f9fafb;
    font-family: inherit;
}

.search-input:focus {
    background: white;
    border-color: var(--primary);
    outline: none;
}

.search-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    width: 18px;
    height: 18px;
    color: var(--text-muted);
}

.toolbar-select {
    padding: 0.75rem 2rem 0.75rem 0.75rem;
    /* Matches muni-selector padding */
    border: 2px solid #e5e7eb;
    /* Matches muni-selector border */
    border-radius: 8px;
    font-size: 0.875rem;
    height: auto;
    background-color: white;
    cursor: pointer;
    min-width: 160px;
    font-family: inherit;
}

.btn-clear-filters {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0 1rem;
    height: 36px;
    border: 1px solid transparent;
    background: transparent;
    color: var(--text-muted);
    font-size: 0.875rem;
    font-weight: 600;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-clear-filters:hover {
    background: #fee2e2;
    color: #ef4444;
}

.btn-clear-filters i {
    width: 16px;
    height: 16px;
}

/* Mobile Toggle */
.mobile-filter-toggle {
    display: none;
    /* Hidden on desktop */
}

/* Ensure View allows scrolling of internal content */
#view-reports {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    /* Header stays, content scrolls */
}

.tab-content {
    display: none;
    flex: 1;
    overflow-y: auto;
    /* Scrollable area */
    padding-bottom: 80px;
    /* Space for bottom nav on mobile */
    min-height: 0;
    /* Flexbox scrolling fix */
}

.tab-content.active {
    display: flex;
    flex-direction: column;
}

.reports-list {
    padding: 1rem;
    display: grid;
    grid-template-columns: 1fr;
    /* Mobile: 1 column */
    gap: 1rem;
}

/* Tablet: 2 columns */
@media (min-width: 768px) {
    .reports-list {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Desktop: 3 columns */
@media (min-width: 1024px) {
    .reports-list {
        grid-template-columns: repeat(3, 1fr);
    }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .reports-header-layout {
        flex-direction: column;
        align-items: stretch;
        gap: 0.75rem;
    }

    .reports-controls-container {
        flex-direction: column;
        align-items: stretch;
    }

    .reports-toolbar {
        display: none;
        /* Hide desktop toolbar on mobile */
    }

    .reports-toolbar.active {
        display: flex;
        flex-direction: column;
        width: 100%;
        animation: slideDown 0.2s ease-out;
    }

    .mobile-filter-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        background: white;
        border: 1px solid #e5e7eb;
        padding: 0.5rem;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        width: 100%;
        height: 36px;
    }

    .search-group {
        width: 100%;
    }

    .toolbar-select {
        width: 100%;
    }
}

/* Dashboard */
.app-content {
    display: flex;
    flex: 1;
    overflow: hidden;
}

.sidebar {
    width: 320px;
    background: white;
    border-right: 1px solid #e5e7eb;
    display: flex;
    flex-direction: column;
    padding: 1.5rem;
}

.map-container {
    flex: 1;
    position: relative;
}

#map {
    height: 100%;
    width: 100%;
}

/* Form Components */
.muni-selector {
    padding: 0.75rem;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    width: 100%;
    margin-bottom: 1rem;
    font-family: inherit;
}

.btn-action {
    background: var(--primary);
    color: white;
    padding: 1rem;
    border-radius: 8px;
    border: none;
    font-weight: 700;
    cursor: pointer;
    width: 100%;
}

.btn-action:disabled {
    background: #d1d5db;
    cursor: not-allowed;
}

.btn-orange {
    background: #f97316;
    /* Orange 500 */
    color: white !important;
    padding: 1rem;
    border-radius: 8px;
    border: none;
    font-weight: 700;
    cursor: pointer;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: all 0.2s;
    text-decoration: none;
}

.btn-orange:hover {
    background: #ea580c;
    /* Orange 600 */
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);
}

.btn-orange i {
    width: 20px;
    height: 20px;
}

/* Privacy Classes */
.private-field.hidden {
    display: none;
}

/* RBAC: Control de Acceso Basado en Roles */
/* Por defecto ocultamos todo lo restringido */
.role-restricted,
.admin-only {
    display: none;
}

/* Solo usuarios autenticados con roles específicos ven botones de reporte/acción */
body.role-admin .role-restricted,
body.role-municipal .role-restricted,
body.role-citizen .role-restricted {
    display: block;
}

/* Solo los administradores ven el panel de administración */
body.role-admin .admin-only {
    display: block;
}

/* El invitado (role-guest) NO tiene ninguna regla que ponga display: block, por lo que permanecerá oculto. */

/* Sidebar Map Controls */
.map-controls {
    display: flex;
    gap: 0.75rem;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #eee;
}

.btn-map-tool {
    background: #f3f4f6;
    border: 1px solid #e5e7eb;
    flex: 1;
    height: 48px;
    border-radius: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    color: var(--text-main);
    transition: all 0.2s;
}

.btn-map-tool:hover {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Custom Toast Notifications */
.toast-container {
    position: fixed;
    top: 2rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    width: 90%;
    max-width: 400px;
}

.toast {
    background: white;
    padding: 1rem 1.5rem;
    border-radius: 12px;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-weight: 600;
    font-size: 0.9375rem;
    animation: slideIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    border-left: 6px solid var(--primary);
    color: var(--text-main);
}

.toast.error {
    border-left-color: #ef4444;
}

.toast.success {
    border-left-color: #10b981;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-2rem);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.toast.fade-out {
    animation: fadeOut 0.3s ease-in forwards;
}

@keyframes fadeOut {
    to {
        opacity: 0;
        transform: translateY(-2rem);
    }
}

/* Modal System */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 2000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(4px);
}

.modal.active {
    display: flex;
}

.modal-content {
    background: white;
    padding: 2rem;
    border-radius: 20px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.btn-close {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: var(--text-muted);
}

/* Sidebar Navigation */
.sidebar-nav {
    display: flex;
    flex-direction: column;
}

.nav-item {
    width: 100%;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 1rem;
    border: none;
    background: transparent;
    border-radius: 12px;
    font-size: 0.9375rem;
    font-weight: 600;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    margin-bottom: 0.5rem;
    font-family: inherit;
}

.nav-item:hover {
    background: #f9fafb;
    color: var(--text-main);
}

.nav-item.active {
    background: #ecfdf5;
    color: var(--primary);
}

.nav-item i {
    width: 20px;
    height: 20px;
}

/* Content View Management */
.content-view {
    flex: 1;
    position: relative;
    overflow: hidden;
}

.view {
    display: none;
    height: 100%;
    width: 100%;
}

.view.active {
    display: flex;
    flex-direction: column;
}

/* Reports History View */
#view-reports {
    background: var(--bg-light);
    overflow-y: auto;
}

.view-header {
    padding: 1rem 2rem;
    background: white;
    border-bottom: 1px solid #e5e7eb;
}

.view-header h2 {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
}

.view-header p {
    color: var(--text-muted);
    font-size: 0.9375rem;
}

/* Tabs System */
.tabs-container {
    display: flex;
    gap: 0.5rem;
    padding: 0.5rem 2rem 0;
    background: white;
    border-bottom: 2px solid #e5e7eb;
}

.tab-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.875rem 1.5rem;
    border: none;
    background: transparent;
    border-radius: 12px 12px 0 0;
    font-size: 0.9375rem;
    font-weight: 600;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    font-family: inherit;
}

.tab-btn:hover {
    background: #f9fafb;
    color: var(--text-main);
}

.tab-btn.active {
    color: var(--primary);
    background: #ecfdf5;
}

.tab-btn.active::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--primary);
}

.tab-btn i {
    width: 18px;
    height: 18px;
}

/* Tab Content */
.tab-content {
    display: none;
    flex-direction: column;
    flex: 1;
    overflow-y: auto;
}

.tab-content.active {
    display: flex;
}

/* Filter Info */
.filter-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 2rem;
    background: #f0fdf4;
    border-bottom: 1px solid #d1fae5;
    color: var(--primary-dark);
    font-size: 0.875rem;
    font-weight: 600;
}

.filter-info i {
    width: 18px;
    height: 18px;
}

/* Reports List */
.reports-list {
    padding: 2rem;
    display: grid;
    gap: 1.5rem;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
}

.report-card {
    background: white;
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid #e5e7eb;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    gap: 1rem;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.report-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

.report-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
}

.category-tag {
    background: #f3f4f6;
    color: var(--text-main);
    padding: 0.375rem 0.875rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
}

.status-badge {
    padding: 0.375rem 0.875rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    white-space: nowrap;
}

.status-pending {
    background: #fef3c7;
    color: #92400e;
}

.status-in_progress {
    background: #dbeafe;
    color: #1e40af;
}

.status-resolved {
    background: #dcfce7;
    color: #166534;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.report-description {
    font-size: 0.9375rem;
    color: var(--text-main);
    line-height: 1.6;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.report-meta {
    margin-top: auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.8125rem;
    color: var(--text-muted);
    padding-top: 1rem;
    border-top: 1px solid #f3f4f6;
}

.report-stats-grid {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-top: 0.75rem;
    padding: 0.5rem 0;
    border-top: 1px solid #f3f4f6;
    flex-wrap: wrap;
}

.report-stats {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.stat-badge {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.75rem;
    color: var(--text-muted);
    background: #f8fafc;
    padding: 4px 8px;
    border-radius: 6px;
    transition: all 0.2s;
}

.stat-badge:hover {
    background: #f1f5f9;
    color: var(--text-main);
}

.stat-badge i {
    width: 16px;
    height: 16px;
    stroke-width: 2.5px;
}

.priority-stars {
    display: flex;
    gap: 1px;
    color: #fbbf24;
    /* Amber 400 */
}

.priority-stars i,
.priority-stars svg {
    width: 14px;
    height: 14px;
    stroke: currentColor;
    fill: none;
    /* Outline by default */
}

.priority-stars .active {
    fill: currentColor !important;
    /* Fill active stars */
}

.priority-stars .inactive {
    color: #cbd5e1 !important;
    /* Slate 300 for inactive */
    fill: none !important;
    opacity: 0.5;
}

.report-author {
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    font-weight: 600;
    color: var(--primary);
    font-size: 0.85rem;
    padding: 4px 8px;
    border-radius: 6px;
    background: #ecfdf5;
    margin-right: auto;
}

.report-author:hover {
    background: #d1fae5;
    text-decoration: none;
}

.report-location {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.report-location i {
    width: 14px;
    height: 14px;
}

.empty-state {
    grid-column: 1 / -1;
    text-align: center;
    padding: 4rem 2rem;
    color: var(--text-muted);
}

.empty-state i {
    width: 64px;
    height: 64px;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.empty-state p {
    font-size: 1rem;
    font-weight: 500;
}

/* Report Detail View (Refactor) */
/* Desktop Detail View Overlay */
@media (min-width: 1024px) {
    #view-report-detail {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 2000;
        /* Ensure high z-index to overlay everything on desktop */
        background: white;
    }
}

/* Report Detail View (Refactor) */
.view-detail {
    background: #f3f4f6;
    height: 100%;
    /* Fill parent flex container */
}

/* Ensure detail view is flex when active */
.view-detail.active {
    display: flex;
    flex-direction: column;
}

.detail-content-scroll {
    flex: 1;
    overflow-y: auto;
    padding: 2rem;
}

.detail-grid {
    display: grid;
    grid-template-columns: 1.5fr 1fr;
    gap: 2rem;
    max-width: 1200px;
    margin: 0 auto;
}

@media (max-width: 900px) {
    .detail-grid {
        grid-template-columns: 1fr;
    }
}

.detail-card {
    background: white;
    padding: 1.5rem;
    border-radius: 16px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    margin-bottom: 2rem;
}

.detail-section-title {
    font-size: 1.125rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid #f3f4f6;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-main);
}

.detail-map-large {
    width: 100%;
    height: 400px;
    border-radius: 16px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
    z-index: 1;
}

/* Carousel */
.evidences-carousel {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding-bottom: 1rem;
    scrollbar-width: thin;
}

.evidence-thumbnail-container {
    flex: 0 0 120px;
    height: 120px;
    cursor: pointer;
    transition: transform 0.2s;
}

.evidence-thumbnail-container:hover {
    transform: translateY(-2px);
}

.evidence-thumbnail {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 12px;
    border: 2px solid transparent;
}

.evidence-thumbnail-container:hover .evidence-thumbnail {
    border-color: var(--primary);
}

.evidence-thumbnail-file {
    width: 100%;
    height: 100%;
    background: #f3f4f6;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    color: var(--text-muted);
    font-size: 0.7rem;
    border: 1px solid #e5e7eb;
}

/* Lightbox */
.lightbox {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.9);
    align-items: center;
    justify-content: center;
    flex-direction: column;
}

.lightbox.active {
    display: flex;
}

.lightbox-content {
    max-width: 90%;
    max-height: 80vh;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
}

.lightbox-close {
    position: absolute;
    top: 20px;
    right: 35px;
    color: #f1f1f1;
    font-size: 40px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
}

.lightbox-close:hover {
    color: var(--primary);
}

.lightbox-download {
    margin-top: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: var(--primary);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
    transition: background 0.2s;
}

.lightbox-download:hover {
    background: #059669;
}

/* Button Back */
.btn-back {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-weight: 600;
    cursor: pointer;
    margin-right: auto;
    font-size: 0.9375rem;
    transition: color 0.2s;
}

.btn-back:hover {
    color: var(--primary);
}

/* Action Buttons Styles */
.detail-actions {
    display: flex;
    gap: 0.75rem;
    align-items: center;
    flex-wrap: wrap;
    margin-top: 0.5rem;
}

.btn-vote,
.btn-follow {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.6rem 1rem;
    border: 1px solid #e5e7eb;
    background: white;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.9rem;
    color: var(--text-main);
    transition: all 0.2s;
    font-weight: 500;
}

.btn-vote:hover,
.btn-follow:hover {
    background: #f9fafb;
    border-color: #d1d5db;
}

.btn-vote.active {
    background: #f0fdf4;
    border-color: #10b981;
    color: #065f46;
}

.btn-vote.active i,
.btn-vote.active svg {
    color: #10b981 !important;
    fill: #10b981 !important;
}

.btn-follow {
    margin-left: auto;
    background: #1f2937;
    color: white;
    border-color: #1f2937;
}

.btn-follow:hover {
    background: #111827;
    color: white;
}

.btn-follow.active {
    background: #f0fdf4;
    color: #065f46;
    border-color: #10b981;
}

.btn-follow.active i {
    color: #10b981 !important;
}

/* --- RESPONSIVE DESIGN PRE-REFACTOR (Removed) --- */

/* --- PERFIL DE USUARIO --- */
.profile-container {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 2rem;
    padding: 1rem;
}

.profile-sidebar {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.profile-avatar-section {
    background: white;
    padding: 2rem;
    border-radius: 16px;
    border: 1px solid #e5e7eb;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
}

.avatar-large {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: #f3f4f6;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #9ca3af;
    overflow: hidden;
    border: 3px solid var(--primary-light);
}

.avatar-large img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.avatar-large i {
    width: 50px !important;
    height: 50px !important;
}

.trust-meter-card {
    background: linear-gradient(135deg, #065f46 0%, #064e3b 100%);
    color: white;
    padding: 1.5rem;
    border-radius: 16px;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
}

.trust-meter-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75rem;
}

.trust-label {
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    opacity: 0.9;
}

.trust-value {
    font-size: 1.25rem;
    font-weight: 800;
}

.trust-progress-bg {
    height: 8px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    margin-bottom: 0.75rem;
    overflow: hidden;
}

.trust-progress-fill {
    height: 100%;
    background: #34d399;
    transition: width 0.5s ease;
}

.trust-hint {
    font-size: 0.75rem;
    line-height: 1.4;
    opacity: 0.8;
}

.profile-main {
    background: white;
    padding: 2rem;
    border-radius: 16px;
    border: 1px solid #e5e7eb;
}

.profile-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
}

.profile-form .form-group label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.5rem;
}

.form-footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid #f3f4f6;
    display: flex;
    justify-content: flex-end;
}

@media (max-width: 768px) {
    .profile-container {
        grid-template-columns: 1fr;
    }

    .profile-grid {
        grid-template-columns: 1fr;
    }
}

/* --- GAMIFICACIÓN --- */
.level-card {
    background: #fff;
    padding: 1.5rem;
    border-radius: 16px;
    border: 1px solid #e5e7eb;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: 0.75rem;
}

.level-badge {
    font-size: 3rem;
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
}

.level-info h3 {
    font-size: 1.125rem;
    color: #111827;
    margin-bottom: 0.25rem;
}

.level-number {
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--primary);
    text-transform: uppercase;
}

.level-progress-container {
    width: 100%;
    margin-top: 0.5rem;
}

.level-progress-bar {
    height: 10px;
    background: #f3f4f6;
    border-radius: 5px;
    overflow: hidden;
    margin-bottom: 0.5rem;
}

.level-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary) 0%, #34d399 100%);
    transition: width 1s ease-in-out;
}

.level-xp-text {
    font-size: 0.75rem;
    color: #6b7280;
    font-weight: 600;
}

/* XP Guide Button */
.btn-xp-guide {
    width: 100%;
    margin-top: 0.75rem;
    padding: 0.5rem;
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    color: var(--primary);
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.btn-xp-guide:hover {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.btn-xp-guide i {
    width: 16px;
    height: 16px;
}

.stats-summary-card {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
    background: white;
    padding: 1rem;
    border-radius: 16px;
    border: 1px solid #e5e7eb;
}

.stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
}

.stat-value {
    font-weight: 800;
    color: #111827;
    font-size: 1.1rem;
}

.stat-label {
    font-size: 0.7rem;
    color: #6b7280;
    text-transform: uppercase;
    font-weight: 600;
}

/* Clickable User names */
.user-link {
    cursor: pointer;
    font-weight: 600;
    color: var(--primary);
    transition: text-decoration 0.2s;
}

.user-link:hover {
    text-decoration: underline;
}

/* Public Profile Modal */
.profile-modal-compact {
    max-width: 450px !important;
}

.public-profile-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    padding: 1.5rem 0;
}

.public-stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin: 1.5rem 0;
    padding: 1rem;
    background: #f9fafb;
    border-radius: 12px;
}

.join-date {
    font-size: 0.8rem;
    color: #9ca3af;
    text-align: center;
    margin-top: 1rem;
    display: block;
}

/* --- COMENTARIOS --- */
.comments-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 1rem;
}

.comment-item {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    background: #f9fafb;
    border-radius: 12px;
    align-items: flex-start;
    border: 1px solid #f3f4f6;
}

.comment-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    background: var(--primary-light);
    color: var(--primary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    font-weight: 700;
    flex-shrink: 0;
    border: 2px solid white;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.comment-content {
    flex: 1;
}

.comment-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.25rem;
    align-items: center;
}

.comment-author {
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--text-main);
}

.comment-date {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.comment-text {
    font-size: 0.9375rem;
    line-height: 1.5;
    color: #4b5563;
}

/* Default hidden mobile items on desktop */
.mobile-nav,
/* FAB Styling (Global Default) */
.fab-report {
    display: none;
    position: fixed;
    z-index: 1001;
}

/* --- Responsive Design (Ultra Compact) --- */
@media (max-width: 1100px) {
    .sidebar {
        display: none !important;
    }

    .main-header {
        height: 60px;
        flex-shrink: 0;
        padding: 0 1rem;
        position: relative;
        /* Back to normal flow in flex column */
        top: auto;
        left: auto;
        right: auto;
        z-index: 100;
    }

    .logo h1 {
        font-size: 1rem;
    }

    .user-info span {
        display: none;
    }

    .app-content {
        flex: 1;
        /* Take all remaining space */
        min-height: 0;
        /* Allow shrinking below content size */
        overflow: hidden;
        display: flex;
        flex-direction: column;
        position: relative;
        top: auto;
        bottom: auto;
    }

    /* Bottom Nav Ultra Slim */
    .mobile-nav {
        display: flex !important;
        height: 60px;
        flex-shrink: 0;
        background: white;
        border-top: 1px solid #e5e7eb;
        justify-content: space-around;
        align-items: center;
        z-index: 9999;
        padding-bottom: env(safe-area-inset-bottom);
        box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
    }

    .mobile-nav .nav-item {
        flex: 1;
        flex-direction: column;
        gap: 2px;
        padding: 4px 0;
        margin-bottom: 0;
        border-radius: 0;
        height: 100%;
        font-size: 0.7rem;
        justify-content: center;
        align-items: center;
    }

    .mobile-nav .nav-item i {
        width: 20px;
        height: 20px;
    }

    /* FAB Contextual - Mobile Only */
    .fab-report {
        display: none;
        /* Controlado por JS */
        position: fixed;
        bottom: 75px;
        right: 15px;
        width: 60px;
        height: 60px;
        background: var(--primary);
        color: white;
        border-radius: 50%;
        border: none;
        box-shadow: 0 8px 15px rgba(16, 185, 129, 0.4);
        display: none;
        /* Display flex set by JS */
        align-items: center;
        justify-content: center;
        z-index: 1001;
        cursor: pointer;
        transition: transform 0.2s, background 0.2s;
    }

    .fab-report i {
        width: 30px;
        height: 30px;
    }

    /* Overlap Fix for Landscape - Reposition FAB to avoid Map Tools */
    @media (orientation: landscape) and (max-height: 500px) {
        .fab-report {
            bottom: 10px !important;
            left: 10px !important;
            right: auto !important;
        }

        .floating-map-tools {
            top: 5px !important;
        }

        .main-header {
            height: 50px;
        }

        .mobile-nav {
            height: 50px;
        }
    }

    /* Map Tools - Floating on Map (Mobile Only) */
    .floating-map-tools {
        position: absolute;
        top: 10px !important;
        right: 12px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        gap: 8px;
        align-items: flex-end;
        pointer-events: none;
    }

    .floating-map-tools>* {
        pointer-events: auto;
    }

    .muni-selector-compact {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 20px;
        padding: 6px 12px;
        font-size: 0.8rem;
        font-weight: 600;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        max-width: 180px;
        color: var(--text-main);
    }

    .map-action-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .btn-map-float {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background: white;
        border: 1px solid #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        color: var(--text-main);
        transition: all 0.2s;
    }

    .detail-grid {
        gap: 1rem;
    }

    .detail-content-scroll {
        padding: 1rem;
        padding-bottom: 100px;
    }

    .detail-map-large {
        height: 300px;
    }
}

/* Global Hidden Items (Desktop View - Force Hide) */
@media (min-width: 1101px) {

    .mobile-nav,
    .fab-report,
    .floating-map-tools {
        display: none !important;
    }
}

/* Profile Scrollable Containers */
.profile-sidebar {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    overflow-y: auto;
    padding-right: 0.5rem;
    /* On mobile/tablet, let it flow naturally */
    max-height: none;
}

@media (min-width: 1101px) {
    .profile-sidebar {
        max-height: calc(100vh - 200px);
    }
}

.profile-sidebar::-webkit-scrollbar {
    width: 6px;
}

.profile-sidebar::-webkit-scrollbar-track {
    background: #f3f4f6;
    border-radius: 3px;
}

.profile-sidebar::-webkit-scrollbar-thumb {
    background: #d1d5db;
    border-radius: 3px;
}

.profile-sidebar::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
}

/* XP Modal Styles */
.modal-xp {
    max-width: 500px;
}

.xp-rewards-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.xp-reward-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: #f9fafb;
    border-radius: 12px;
    border: 1px solid #e5e7eb;
    transition: all 0.2s;
}

.xp-reward-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.xp-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.xp-icon i {
    width: 24px;
    height: 24px;
}

.xp-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    flex: 1;
}

.xp-action {
    font-weight: 600;
    color: #111827;
    font-size: 0.9rem;
}

.xp-value {
    font-weight: 700;
    color: var(--primary);
    font-size: 1.1rem;
}

.xp-tip {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 1rem;
    background: #fef3c7;
    border-radius: 12px;
    border: 1px solid #fbbf24;
}

.xp-tip i {
    width: 20px;
    height: 20px;
    color: #f59e0b;
    flex-shrink: 0;
    margin-top: 2px;
}

.xp-tip p {
    margin: 0;
    font-size: 0.85rem;
    color: #78350f;
    line-height: 1.5;
}

/* User Profile Modal Redesign */
.profile-card-modal {
    max-width: 420px;
    padding: 2.5rem 1.5rem 2rem;
    text-align: center;
    border-radius: 28px;
}

.profile-card-body {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.profile-avatar-wrapper {
    position: relative;
    width: 120px;
    height: 120px;
    margin: 0 auto;
    cursor: pointer;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.profile-avatar-wrapper:hover {
    transform: scale(1.05);
}

.profile-avatar-large {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid var(--primary);
    padding: 3px;
    background: white;
    box-shadow: 0 8px 16px rgba(16, 185, 129, 0.2);
}

.profile-info-large h3 {
    font-size: 1.5rem;
    font-weight: 800;
    color: #111827;
    margin: 0.75rem 0 0.25rem;
}

.rank-badge-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    margin-top: 10px;
}

.rank-icon-wrapper {
    width: 44px;
    height: 44px;
    background: #f8fafc;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    border: 1px solid #f1f5f9;
}

.rank-icon {
    width: 24px;
    height: 24px;
    color: #475569;
}

.rank-name {
    color: #10b981;
    font-weight: 800;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

.profile-stats-grid-extended {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.25rem;
    background: #f8fafc;
    padding: 1.5rem 1.25rem;
    border-radius: 20px;
    margin: 0.5rem 0;
}

.stat-item-ext {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

/* Specific layout for followers/following in second row if too many 
   We use grid-column-span or just center the last two if they are 5 in total
*/
.stat-item-ext:nth-child(4) {
    grid-column: 1 / 2;
}

.stat-item-ext:nth-child(5) {
    grid-column: 2 / 3;
}

.stat-value-ext {
    font-size: 1.4rem;
    font-weight: 900;
    color: #1e293b;
}

.stat-label-ext {
    font-size: 0.65rem;
    font-weight: 800;
    color: #64748b;
    letter-spacing: 1px;
}

.xp-progress-section {
    width: 100%;
}

.xp-progress-wrapper {
    height: 8px;
    background: #e2e8f0;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
}

.xp-progress-fill-card {
    height: 100%;
    background: linear-gradient(90deg, #10b981 0%, #34d399 100%);
    border-radius: 10px;
    transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.xp-progress-text {
    font-size: 0.8rem;
    font-weight: 700;
    color: #64748b;
}

.profile-footer-date {
    font-size: 0.85rem;
    color: #94a3b8;
    margin-top: 5px;
}

/* Filters Row Layout */
.filters-row {
    display: flex;
    gap: 1rem;
    align-items: flex-end;
}

.filters-row-mobile {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    -webkit-overflow-scrolling: touch;
}

.filters-row-mobile .filter-group,
.filters-row-mobile .mobile-muni-container {
    flex: 0 0 auto;
    min-width: 150px;
}

@media (max-width: 768px) {
    .filters-row {
        flex-direction: column;
        align-items: stretch;
        gap: 0.5rem;
    }

    .view-header {
        flex-direction: column;
        align-items: flex-start !important;
        gap: 1rem;
    }
}

/* Mobile Layout Optimizations for Reports */
@media (max-width: 768px) {

    /* Hide desktop filters completely on mobile to avoid duplication/stacking */
    /* Hide desktop filters completely on mobile to avoid duplication/stacking */
    .view-header .filters-row {
        display: none !important;
    }

    /* Except title container, define if specific classes needed or just use nth-child logic if structure is simple.
       Better to target specifically what to hide.
       The structure is: 
       .view-header -> div(title) + div(filters-row) + div(filter-group-sort)
    */

    /* Re-enable title display specifically if accidentally hidden by generic rule above
       Assuming the first child is the title container 
    */
    .view-header>div:first-child {
        display: block !important;
        width: 100%;
    }

    /* Compact Header */
    .view-header {
        padding: 0.75rem 0;
        flex-direction: row;
        /* Keep row to allow title + actions if any */
        min-height: auto;
        border-bottom: 1px solid #f1f5f9;
        margin-bottom: 0.5rem;
    }

    .view-header h2 {
        font-size: 1.25rem;
        margin-bottom: 0.25rem;
    }

    .view-header p {
        font-size: 0.8rem;
        margin-bottom: 0;
    }

    /* Ensure Reports View takes full height */
    #view-reports {
        display: flex;
        flex-direction: column;
        height: 100%;
        padding-bottom: 80px;
        /* Space for bottom nav */
    }

    /* Mobile Filters Container Adjustment */
    .reports-controls-mobile {
        flex-shrink: 0;
        margin-bottom: 0.5rem;
    }

    /* Content Area Scroll */
    .tab-content.active {
        flex: 1;
        overflow-y: auto;
        padding-bottom: 2rem;
        /* Fix for Safari iOS scroll */
        -webkit-overflow-scrolling: touch;
    }
}

/* --- CRITICAL MOBILE FIXES --- */

/* 1. Global View Scroll for Mobile */
@media (max-width: 1100px) {

    /* Permitir que las vistas manejen su propio scroll (excepto mapa) */
    .view:not(#view-map) {
        /* No forzar display: block aquí para no mostrar las ocultas */
        height: 100%;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch;
        padding-bottom: 90px !important;
        /* Espacio para navbar fixed */
    }

    .view:not(#view-map).active {
        display: flex !important;
        /* Flex para mantener layout interno (detail view, etc) */
        flex-direction: column;
    }

    /* Regla Nuclear: Ocultar explícitamente vistas inactivas en móvil */
    .view:not(#view-map):not(.active) {
        display: none !important;
    }



    /* El contenido del tab debe fluir, no scrollear doble */
    .tab-content {
        height: auto;
        overflow: visible;
        padding-bottom: 0;
    }

    /* Map view needs to be fixed/hidden overflow to let map panning work */
    #view-map {
        overflow: hidden !important;
        padding-bottom: 60px !important;
    }

    /* Remove limits from profile container to let parent view scroll */
    .profile-sidebar {
        max-height: none !important;
        overflow: visible !important;
        padding-bottom: 0;
    }

    .view-header {
        margin-top: 0;
        padding-top: 1rem;
    }

    .app-content {
        padding-bottom: 0 !important;
        /* Managed by views now */
        overflow: hidden;
        /* Hide anything behind views */
    }

    /* Helper: Mobile Only Visibility */
    .mobile-only {
        display: block !important;
    }

    .desktop-only {
        display: none !important;
    }
}

@media (min-width: 1101px) {
    .mobile-only {
        display: none !important;
    }

    /* Ocultar filtros móviles en escritorio para evitar duplicados */
    .filters-row-mobile {
        display: none !important;
    }

    /* Asegurar visibilidad de elementos header */
    /* Asegurar visibilidad de elementos header con layout correcto */
    .view-header .filter-group {
        display: block;
    }

    .view-header .filters-row {
        display: flex;
        gap: 1rem;
        align-items: flex-end;
    }
}

/* 2. Map Floating Controls Styles */
/* 2. Map Floating Controls Styles */
.floating-map-tools {
    position: absolute;
    top: 10px;
    right: 10px;
    left: 10px;
    z-index: 1000;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    pointer-events: none;
}

.floating-map-tools>* {
    pointer-events: auto;
}

.muni-selector-compact {
    background: white;
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 8px;
    font-size: 0.9rem;
    max-width: 60%;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

.map-action-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.btn-map-float {
    width: 40px;
    height: 40px;
    background: white;
    border: 1px solid #ccc;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    font-size: 1.2rem;
    color: #333;
}

.btn-map-float:active {
    background: #f0f0f0;
}

/* Report ID Badge Style */
.report-id-badge {
    background-color: #334155;
    color: #e2e8f0;
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-family: monospace;
    font-weight: bold;
    margin-right: 0.5rem;
}

/* Debug Logs Panel */
#debug-logs-panel {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 400px;
    max-height: 500px;
    background: var(--log-bg);
    color: var(--log-text);
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
    z-index: 10000;
    display: flex;
    flex-direction: column;
    font-family: 'Courier New', Courier, monospace;
    font-size: 12px;
    overflow: hidden;
    border: 1px solid #374151;
}

@media (max-width: 480px) {
    #debug-logs-panel {
        width: calc(100% - 40px);
        max-height: 70vh;
    }
}

.logs-header {
    background: #111827;
    padding: 10px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #374151;
}

.logs-header h3 {
    margin: 0;
    font-size: 14px;
    color: #10b981;
}

.logs-actions {
    display: flex;
    gap: 8px;
}

.logs-actions button {
    background: #374151;
    color: white;
    border: none;
    padding: 4px 8px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 10px;
}

.logs-actions button:hover {
    background: #4b5563;
}

#btn-close-logs {
    background: #ef4444;
    font-weight: bold;
}

.logs-content {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
}

.log-item {
    margin-bottom: 8px;
    padding-bottom: 8px;
    border-bottom: 1px solid #374151;
    line-height: 1.4;
}

.log-time {
    color: #9ca3af;
    margin-right: 5px;
}

.log-level {
    font-weight: bold;
    margin-right: 5px;
    padding: 1px 4px;
    border-radius: 3px;
    text-transform: uppercase;
    font-size: 10px;
}

.log-debug .log-level {
    color: #9ca3af;
}

.log-info .log-level {
    color: #3b82f6;
}

.log-warn .log-level {
    color: #f59e0b;
}

.log-error .log-level {
    color: #ef4444;
}

.log-msg {
    word-break: break-all;
}

.log-data {
    display: block;
    background: #111827;
    padding: 5px;
    margin-top: 5px;
    border-radius: 4px;
    color: #10b981;
    white-space: pre-wrap;
    font-size: 10px;
}

.no-logs {
    text-align: center;
    padding: 20px;
    color: #6b7280;
}

/* Guest Welcome Message */
.guest-welcome-card {
    background: white;
    padding: 3rem 2rem;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    border: 1px solid #f1f5f9;
}

.guest-msg-icon {
    width: 64px;
    height: 64px;
    color: #10b981;
    margin-bottom: 1.5rem;
}

.guest-welcome-card h3 {
    font-size: 1.5rem;
    color: #1e293b;
    margin-bottom: 1rem;
    font-weight: 800;
}

.guest-welcome-card p {
    color: #64748b;
    line-height: 1.6;
    margin-bottom: 1rem;
}

.guest-msg-quote {
    font-style: italic;
    color: #10b981 !important;
    font-weight: 600;
    margin-top: 1.5rem !important;
}